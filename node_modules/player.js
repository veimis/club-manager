// Exports club manager player module

// Dependencies
var cmUtils = require('club_manager_utils');

module.exports = function cmPlayerModule() {
  function cmPlayer(){}
  var dbName = 'cm_player';
  
  // Add new custom object type
  // cos = pencilblue custom object service
  // util =  pencilblue utilities
  // cb = callback(error, boolean)
  cmPlayer.install = function(cos, util, cb) {
    // Custom object fields
		var player = {
			name: dbName,
			fields: {
				name: { field_type: 'text' },
				number: { field_type: 'text' },
				// TODO Media is mandatory, not working yet 
				//profilePicture: { field_type: 'peer_object', object_type: 'media' },
				description: { field_type: 'wysiwyg' }
			}
		};

		return cmUtils.createCustomObjectType(cos, util, dbName, player, cb);
  };

  // Clear player objects and remove custom object type
  // cos = pencilblue custom object service
  // util = pencilblue utilities
  // cb = callback(error, boolean)
  cmPlayer.uninstall = function(cos, util, cb) {
		return cmUtils.removeCustomObjectType(cos, util, dbName, cb); 
	};
  
  // Query all player objecst from the database.
  // cos = pencilblue custom object service
  // util = pencilblue utitilities
  // cb = callback(error, data)
  cmPlayer.getPlayers = function(cos, util, cb) {
		var selection = ['name', 'number', 'description'];
		return cmUtils.queryCustomObjects(cos, util, dbName, selection, cb);
	}

  return cmPlayer;
};
