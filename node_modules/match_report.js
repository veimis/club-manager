// Exports club manager match report module

// Dependencies
var cmUtils = require('club_manager_utils');

function MatchReport(){}
var dbName = 'cm_match_report';

// Add custom object type
// cos = pencilblue custom object service
// util = pencilblue utilities
// cb = callback(error, boolean)
MatchReport.install = function(cos, util, cb) {
	// Custom object fields
	var matchReport = {
		name: dbName,
		fields: {
			name: { field_type: 'text' },
			date: { field_type: 'date' },
			description: { field_type: 'wysiwyg' },
			players: { field_type: 'child_objects', object_type: 'custom:cm_player' }
		}
	};

	return cmUtils.createCustomObjectType(cos, util, dbName, matchReport, cb);
};

// Clear match report objects and remove custom object type
// cos = pencilblue custom object service
// util = pencilblue utilities
// cb = callback(error, boolean)
MatchReport.uninstall = function(cos, util, cb) {
	return cmUtils.removeCustomObjectType(cos, util, dbName, cb);
};

// Query all match reports from the database
// cos = pencilblue custom object service
// util = pencilblue utilities
// cb = callback(err, data)
MatchReport.getAll = function(cos, util, cb) {
	var selection = ['name', 'date', 'description', 'players'];
	return cmUtils.queryCustomObjects(cos, util, dbName, selection, cb);
};

module.exports = MatchReport;
